<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>PGC Video Textbook - Chapter 2.4: Linkage Disequilibrium (Video Transcript)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">PGC Video Textbook</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" rel="" target="" aria-current="page">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./contact.html" rel="" target="">
 <span class="menu-text">Contact us</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://pgc.unc.edu/" rel="" target="">
 <span class="menu-text">PGC Website</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Chapter 2.4: Linkage Disequilibrium (Video Transcript)</li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./pgc_logo_website_v3.jpeg" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="">
            Source code
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="">
            Report a bug
            </a>
          </li>
      </ul>
    </div>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./welcome.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome to the PGC Video Textbook!</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./toc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Table of Contents</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Chapters</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 1: Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 2: The Genome</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 3: Technologies</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 4: Study Designs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 5: GWAS Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 6: Polygenic Scores</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 7: Ancestry-Specific Analyses and Considerations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 8: Post-GWAS Bioinformatics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 9: Advanced Topics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 10: Other Considerations</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Software Tutorials</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./software_cnvs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CNVs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./software_conditional.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Conditional Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./software_datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datasets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./software_ewas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">EWAS</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./software_geneset.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gene Set Identification</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./software_gwas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GWAS</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./software_genomicSEM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Genomic SEM</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./software_MR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mendelian Randomization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./software_mtag.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MTAG</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./software_prs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PRS</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./software_correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SNP Heritability and Genetic Correlation</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Additional Resources</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./glossary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Glossary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tools/Software Resources</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://pgc.unc.edu/for-researchers/download-results/" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PGC Summary Statistics</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#sec-video1" id="toc-sec-video1" class="nav-link active" data-scroll-target="#sec-video1">What is linkage disequilibrium?</a></li>
  <li><a href="#sec-video2" id="toc-sec-video2" class="nav-link" data-scroll-target="#sec-video2">Measuring linkage disequilibrium</a></li>
  <li><a href="#sec-video3" id="toc-sec-video3" class="nav-link" data-scroll-target="#sec-video3">(Advanced) Measuring linkage disequilibrium</a></li>
  <li><a href="#sec-video4" id="toc-sec-video4" class="nav-link" data-scroll-target="#sec-video4">Computing linkage disequilibrium</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Chapter 2.4: Linkage Disequilibrium (Video Transcript)</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="sec-video1" class="level1">
<h1>What is linkage disequilibrium?</h1>
<p><strong>Title</strong>: What is linkage disequilibrium?</p>
<p><strong>Presenter(s)</strong>: Gábor Mészáros, PhD (Institute of Livestock Sciences (NUWI), University of Natural Resources and Life Sciences)</p>
<p><strong>Gábor Mészáros</strong>:</p>
<p>Hello, everyone. Welcome back to the Genomics Boot Camp to a series about linkage disequilibrium. In this video, we just start to talk about this genomic phenomenon, so therefore, the question is what it is exactly. So what is linkage disequilibrium? And you will know it from this video.</p>
<p>Before we start, let’s activate some of our prior knowledge that you might know from this channel or from other sources. And the two most important issues to highlight here is one that the single nucleotide polymorphisms, or SNPs, exist. These are some markers that are widely used and currently, in my opinion, the most important marker types as for the genomics. Tens of thousands of such SNPs are being genotyped in a cost-effective way on the entire genome, so basically it is a very good way to get to know something about the genomes themselves. And the other bit of information that is important here is the existence of the recombinations or recombination events that are of major biological importance. This means that the nucleotides on our genome are not being inherited independently but in a form of shorter or longer genomic segments from the paternal and maternal side.</p>
<p><em>Mendels Law</em></p>
<p>Such statement about the non-independent inheritance is in conflict with the Mendel’s law of independent assortment, which says genes do not influence each other with regard to the sorting of alleles into genes and every possible combination of alleles for every gene is equally likely to occur. Mendel’s law is, of course, valid when the genes or the parts of the genome are far from each other or, for example, on separate chromosomes, but as you will see, it’s not valid when these genes or SNPs or parts of the genome are very close to each other.</p>
<p><em>Linkage Equilibrium</em></p>
<p>The next few slides I took from the presentation of Professor Henner Simianer from University of Göttingen to demonstrate what happens in such occasions and what, in fact, the linkage disequilibrium is. So, for the sake of simplicity, let’s have an individual with two alleles and we ensure that this individual is entirely heterozygous. Then we mate it with another individual, which is entirely homozygous for these alleles <em>A</em> and <em>B</em>. And when the law of independent assortment is valid, then we get the four possible genotypes and, if our sample is big enough, then we have all these possible genotypes with a 25% probability. So, in our population, we would see that all four genotypes appear in a proportion of 25. In some cases, however, we might notice that these four genotypes are, in fact, not appearing in an equal proportion but very, very differently from each other. In this case, the alleles denoted by the capital letters <em>A</em> and <em>B</em> seem to appear much more frequently together, and also the alleles denoted by the lowercase <em>a</em> and <em>b</em> also appear to occur much more frequently with each other. So, in this case 45% in comparison to a situation when the lowercase <em>a</em> for example and a higher case <em>b</em> would be together in a single individual. The reason for this is, of course, recombination, so we have a non-recombinant gametes on the one side and the recombined gametes on the other side. So, in other words again, in case a recombination happened between these two loci, then we have a different occurrence for these for these gametes. The degree of recombinations is measured by the recombination rate.</p>
<p><em>Linkage Disequilibrium</em></p>
<p>So what we see is a departure from this equal distribution, denoted as a linkage disequilibrium or LD, which is the very frequently used abbreviation. I wanted to underline that LD is, in fact, a parameter of the population, so you need more individuals and, in the best-case scenario, a large number of individuals to determine the LD between two loci in a population. It is, in fact, a non-random association between the loci within this population, which could be measured so we can tell that the two loci are strongly linked or weakly linked or not linked at all together. In other words, the LD tells us something about the strength of the information if we see an allele in a certain locus and what it can tell us about the occurrence of another allele on another locus. There are various methods to measure LD, and we will talk about these measurement possibilities in the next video.</p>
<p><em>Heatmap</em></p>
<p>So, here is an example of a part of a genome with a heat map, so here is basically the darker colors are high LD and lighter colors are low LD. So it’s measured with D’ in this example - don’t worry about this right now. But basically, what I want to show you that the SNPs that are close to each other tend to have a higher LD between each other, and there are, for example, SNPs – for example, #9 and #20 - you see that there are relatively lower LD between them. Also, there are segments on the genome that are so called LD blocks where all the pairwise combinations of the SNPs yield a high LD, so basically this whole block is inherited in one piece. I really like this picture about the LD block structure, in this particular case, in a chicken genome, that demonstrates a similar thing as in a previous picture or previous slide but on a much larger part of the genome. Also, it compares to chicken lines where we see that the same part of the genome could be very different even within the species when we talk about different breeds or, in this case, the different lines. And the reason for this could be that, for example, in this chicken breed, in this particular part of the genome, there are some genes that are very important for this breed, therefore this part of the genome is quite well conserved with very high pairwise LDs in this part and the same genes are, of course, present also in the other breed. In this breed these genes are not important or at least not selected for. Therefore, we do not see such a strong LD block occurring in this breed.</p>
<p><em>Why is LD important</em></p>
<p>This simple picture supposed to illustrate the use of LD and why is it important in the genomics as such. So what we have here is let’s say a chromosome and we have a SNP on them, and let’s say we did some kind of analysis where we found the significance of each SNP, so this would be the higher SNP is, the higher the significance level. Now we see that there we have some kind of a signal here. So the question is: is this the gene of interest that influences our trait? Of course, because we are speaking about SNPs that are themselves just markers and not the causal variants, so this is, in fact, not the gene of interest but actually just shows what region of the genome is interesting. For our case, so we have a region of interest here and most likely the exact gene of interest resides somewhere here. Now the size of this region is determined by the linkage disequilibrium so LD, because most likely this SNP, the highest significant SNP, is connected to all of these nucleotides around. Also that, the parts of the genome that were not observed and, therefore, helps us to find the gene that is actually interesting for us.</p>
<p><em>Summary</em></p>
<p>So, to sum up why LD is important, it actually defines how far we are allowed to or supposed to look from the detected markers when we are looking for the causality on our genome, and it shows the association strength between the observed SNPs and the unobserved genes or QTLs. Also, I want to underline that the LD itself is actually dependent on a population or species, so most likely these association strengths or LD in these regions or the size of the regions might differ between the different populations.</p>
<p><em>Applications</em></p>
<p>As for the applications of LD in genomics, it is really, really wide-ranging, so I just mentioned a few examples here. So in evolutionary biology, it allows us to reflect on past events and gives insight into evolutionary history. When it comes to genetic diversity, it’s a similar as in a previous point, but we often compute the effective population size for our populations, and one of the computation methods is via LD itself. Then we can tell something about the artificial or natural selection events on the genome when it again comes to the population with the so-called selection signatures and the genetic hitchhiking - these are events when the actual selected gene drags along part of the surrounding genome and appearing in a population as a selection signature. So this size is determined by the LD itself. My small schematics showed an example of a genome-wide association study where we could search for causal genes and, as it was mentioned, there we could locate our search to these interesting regions where the most important or most significant SNPs reside. And LD is also used in a genomic selection in an indirect way, so here the question is that, how many SNPs we need that are more or less equally distributed on the genome so the whole genome is covered. So we could detect these very small QTLs and very small genes that affect our trait of interest, which is usually a quantitative trait, so it is influenced by many genes of small effect. We need to ensure that the whole genome is covered properly, so that all of these small genes are connected to at least one snip in a high enough LD and, therefore, taken into account.</p>
<p>When the genomic LD value is calculated, so again a slide to give an answer to the initial question: what is linkage disequilibrium? So, linkage disequilibrium is a parameter that quantifies the non-random association between the loci. It shows if the frequency of a different alleles between two loci is higher or lower than it would be expected if the loci were independent from each other and associated randomly.</p>
<p><em>Conclusion</em></p>
<p>And the very last summary slide for the entire presentation we talked about SNPs, markers that allow us to track the associations between parts of the genome, and such associations and such connections could be non-random, especially if the SNPs or markers or parts of the genome are very close to each other. Such non-random association is called linkage disequilibrium or LD in a shortened abbreviated form. And there are wide-ranging applications of LD within genomics. In the following videos, we will continue with the exact measurement techniques of the linkage disequilibrium. Also, I will provide a very nice hands-on example but, of course, also show the way how the LD is computed for large data sets using PLINK. For today, I thank you for your time and see you at another video on the Genomics Bootcamp Channel. I wish you a very nice day.</p>
<hr>
</section>
<section id="sec-video2" class="level1">
<h1>Measuring linkage disequilibrium</h1>
<p><strong>Title</strong>: How to measure linkage disequilibrium?</p>
<p><strong>Presenter(s)</strong>: Gábor Mészáros, PhD (Institute of Livestock Sciences (NUWI), University of Natural Resources and Life Sciences)</p>
<p><strong>Gábor Mészáros</strong>:</p>
<p>Hello everyone, welcome back to the Genomics Boot Camp. Today we will continue to talk about linkage disequilibrium. Before we start, however, I want to thank you for the 500 subscribers or the over 500 subscribers on the Genomics Boot Camp channel. It seems that there is a continued and ever increasing interest about the contents of the channel, which is, of course, very good news for me and good motivation to move forward. Of course, if you are not subscribed yet. you can use this opportunity to do so. So thank you, thank you, thank you, and without further delay, let’s move on to further discussions about linkage disequilibrium.</p>
<p><em>Linkage disequilibrium</em></p>
<p>So let’s start with a little bit of activation of our prior knowledge. Namely that single nucleotide polymorphisms, or SNPs, exist, and these are actually the main marker types we speak about on this channel. Linkage disequilibrium, as such, also exists, and we spoke about this in the previous video. And in short, it actually measures the non-random associations between SNPs, and there is wide-ranging applications for LD in genomics, but for today’s question: how to measure linkage disequilibrium?</p>
<p>We saw this graph in the previous video, and basically what we see is that some of the allele combinations are appearing much more frequently than others, thus leading to linkage disequilibrium.</p>
<p>This non-random association between some alleles of a different loci can be visualized in such a two by two, table where we have on one side locus A and with the alleles, capital <em>A</em> and small <em>a</em>, and on the top side, locus B with alleles, capital <em>B</em> and small <em>b</em>. Each of the combinations is then represented with a proportion, so basically the p<sub>AB</sub> is the proportion of the combinations for these alleles. If we are interested, for example, in the total proportion of the allele <em>A</em>, then we have it in the right side. The same we can tell about the proportion of all the other alleles, so the&nbsp; lowercase <em>a</em>, the capital <em>B</em>, and this lowercase <em>b</em>. There is one rule if we are talking about biallelic systems that the sum of the proportion of the two alleles sums up to 1.</p>
<p>In case of linkage equilibrium, when the loci A and B are not linked, we can actually compute the genotype proportions based on the allele proportions. This is shown, for example, in the first line, and we can actually do the same for all the other genotypes. One additional comment here, so we use this feature of this previous 2 x 2 tables. So I told you that basically the proportions for the two alleles are summing up to 1, so basically the p<sub><em>b</em></sub> we can also express as 1 - p<sub><em>B</em></sub>. This is, of course, a preferred setting, because we reduce the number of unknowns from four to two. So basically, we just have to work with two variables: p<sub><em>A</em></sub> and p<sub><strong><em>B</em></strong></sub><strong>.</strong> Now this situation is valid for the linkage equilibrium as I mentioned, so when the alleles are unconnected.</p>
<p>In case of linkage disequilibrium, however, these equations do not hold true. In other words, from the proportions of the alleles, we cannot compute the proportion of the genotypes. We cannot compute this, because there is a difference between these two metrics. That is the disequilibrium coefficient or D<em>,</em> and it can be computed as the proportion of the <em>AB</em> together minus the proportion of <em>A</em> times proportion of <em>B</em>, and when we include this equilibrium coefficient to the equations as before we get the proportions of the genotypes. So in other words, this D or this equilibrium coefficient is a measure of the linkage disequilibrium or a coefficient that can be used to express it.</p>
<p><em>D prime</em></p>
<p>But we have a bit of a problem with this this equilibrium coefficient because it’s a bit hard to interpret and the sign is arbitrary so it’s depending on which allele actually you consider first. Of course, there is a common convention to set the capital A and capital <em>B</em> to be the most common allele and the smaller case <em>a</em> and <em>b</em> to be the rare allele. But of course, the rarity of the alleles, or the minor allele frequencies, can change from population to population, even within the same species, so that is not such a big win after all.</p>
<p>Now there is a better version of this D or the disequilibrium coefficient called the D’. That is a scaled version that is computed as shown in this slide. So basically, it is divided by the minimum of these two values, in case the disequilibrium coefficient is lower than zero, or the minimum or of these two values if the disequilibrium coefficient is higher than zero. Now we end up with a coefficient, which is another, a more popular version of the linkage disequilibrium and ranges between minus one and plus one. Extreme values, in this case, imply that at least one of the haplotypes was not observed.</p>
<p>It has several advantages that is the D’ = 1 or D’ = -1 means that the two SNPs are not separated by recombination, so that they are in a complete LD. It also means that if the earlier frequencies of the two loci are relatively similar then the high D’ means that the markers are good surrogates for each other, but in this case, we have also some disadvantages. namely that the D’ estimates are inflated. In case, the sample size is small, and the D’ estimates might be also inflated when one of the alleles is rare.</p>
<p><em>Correlation</em></p>
<p>Then there is a follow-up question if there is a more intuitive way to measure linkage disequilibrium, to which the answer is yes. And that it can be measured straight with the correlation coefficient, or an adapted value anyway. This correlation coefficient as we would expect expresses the mutual relationship between the alleles of the two loci.</p>
<p>Now a little bit of refreshment on correlation, so this is the correlation as we know it from the statistics. So, it has a standardized abbreviation of lowercase <em>r</em> and ranges from -1 to +1. Basically there could be different values for the correlation coefficient, which describe how the two variables behave in relation to each other. So basically, we have an x and a y, and if, with the increasing x, the y decreases, then we have a negative correlation coefficient. And if the two values are increasing, so, with the increasing x, also y increases, then we have a positive correlation coefficient. In between -1 and 1, so the extreme values, so the correlation coefficient expresses the strength of such relationships. And of course, it could be situations when the two values are not correlated, so then the correlation coefficient is zero.</p>
<p>Now for linkage disequilibrium, we use the squared correlation coefficient, so this is the r<sup>2</sup>. So the squared correlation between the markers, and therefore, it ranges between 0 and 1. r<sup>2</sup> of one implies that the markers provide exactly the same information, and the r<sup>2</sup> of zero implied that the two markers are not connected at all, so independent from each other. So, in other words, the r<sup>2</sup> measures a loss of efficiency when a marker A is replaced with the marker B.</p>
<p>Now the r<sup>2</sup> value could be computed from the allele frequencies themselves and what we need is actually just 3 values from here: the joint appearance of <em>A</em> and <em>B</em>, the proportion of capital <em>A</em>, and the proportion of capital B.</p>
<p>Based on these values, we can put them into this very nice equation, and we can compute the correlation coefficient r<sup>2</sup><sub>.</sub> Now I realize that there is quite a jump from the correlation itself to this equation, and I provide actually all the details in an additional video, which I call the advanced or “advanced” video, so you can look at it if you’re interested. It is already uploaded on the Genomics Boot Camp channel.</p>
<p>And once we have our measure of linkage disequilibrium, of course, we can compute the pairwise linkage disequilibria between markers. &nbsp;Such it was done in Qanbari et al., 2010, for this example. So in here, what we have on the y-axis is the linkage disequilibrium, measured in r<sup>2</sup>. On the x-axis, there is a distance between the markers, in this case, measured in morgans, which can be, of course, translated to megabases. So this would be one megabase, two megabase difference, three, four, and five megabase difference. Each dot on this graph is a linkage disequilibrium value for a marker pair, so you see that if the two alleles are very close to each other, then the linkage disequilibrium could be very high up to 1, but then this value quickly goes down to a lower value as the distances between the markers or the genomic distances between the markers increase. This sudden decrease of the average linkage disequilibrium between markers is shown with this dashed line, and in fact, its shape is very typical for all the organisms. We refer to this sudden decrease as linkage disequilibrium decay.</p>
<p>The shape of this LD decay is, in general, similar between the organisms, but the starting values and the further developments can be different when it comes to different species or, in this case, as shown in Pérez O’Brien, 2014, it could be different even when we consider <em>Bos taurus</em> and <em>Bos indicus</em> breeds. This, of course, has some relevance when the LD is used for further genomic analysis as discussed in the last video.</p>
<p><em>Summary</em></p>
<p>So, to summarize this video, the LD characterizes the degree of relationships between the nearby loci. There are various methods and possibilities to measure it. One of them is the disequilibrium coefficient denoted by D or as a D’ - that is a metric to use to quantify the LD but it has some disadvantages. And then the other more commonly used metric is the r<sup>2</sup>, or the squared correlation coefficient. That is a robust measure of the LD. So this is the end of this video. If you’re interested how we arrive to the equation to compute the r<sup>2</sup>, then be sure to check out the next one, a follow-up to this, and if you say that is enough for today, then of course, I thank you for your time and wish you a very nice continuation of the day.</p>
<hr>
</section>
<section id="sec-video3" class="level1">
<h1>(Advanced) Measuring linkage disequilibrium</h1>
<p><strong>Title</strong>: How to measure linkage disequilibrium? (ADVANCED)</p>
<p><strong>Presenter(s)</strong>: Gábor Mészáros, PhD (Institute of Livestock Sciences (NUWI), University of Natural Resources and Life Sciences)</p>
<p><strong>Gábor Mészáros</strong>:</p>
<p>Hello, everyone. Welcome back to another video on the Genomics Boot Camp. This time is a follow-up or an add-on to the previous video how to measure linkage disequilibrium. This video is entitled “advanced,” because we have a bit more equations here as on the average of the channel. The reason I did not include these ones into the previous video is that perhaps not everybody is interested or they don’t like to see, you know, too many equations in an educational video. Therefore, I thought it makes sense to divide the two, but you are here, you are interested, so let’s get to it. I repeat here a few slides that were in the original video in order to provide context, but we will go through these ones in a quicker manner.</p>
<p><em>R-squared</em></p>
<p>We start with this video where we ended last time, and this is our prior knowledge now. And the most important part is the r<sup>2</sup>, so there we have the commonly used robust measure of LD in the previous video. I was just including the summary equation, but in this video, we will have more information on how we arrive to this r<sup>2</sup>.</p>
<p>So again we have the correlation coefficient from a general statistics and abbreviated as a lowercase r, ranges from -1 to +1, and there are various values of the correlation coefficients that are expressing the relationships between the two variables x and y.</p>
<p>Of course, the correlation coefficient is also computed somehow and it is actually computed as a covariance between x and y divided by the square root of variance of x and variance of y. If we want to write out this one in a further detail, so we have this would be the covariance between x and y and the variance of x and the variance of y in these brackets. Basically, the goal of this video is to provide you with the link between this equation and the r<sup>2</sup> equation to compute the linkage disequilibrium that was shown at the end of the last video and also will be shown more times also in this one.</p>
<p>So for refreshment we have the r<sup>2</sup> value that is the squared correlation between the markers, therefore ranges between 0 and 1. And the value of 1 implies that the markers provide exactly the same information, while the value of 0 for the r square implies that the markers are not connected at all to each other. Therefore, it measured the loss of efficiency when a marker <em>A</em> is replaced by a marker <em>B</em>.</p>
<p>The r<sup>2</sup> itself could be computed based on the allele frequencies from this 2x2 table, so we have a locus A and the locus B and each of them has two values capital <em>B</em> and small <em>b</em> and a capital <em>A</em> and a small <em>a</em>. So these values are valid for a biallelic system - so these kind of computations are valid only in a case that the markers have a two alleles, but because the SNPs on the SNP chips are biallelic by design, then we are good to go. There are, in fact, only three values that we need; that is the joint occurrence of <em>A</em> and <em>B</em> and the respective frequencies of capital <em>A</em> and capital <em>B</em>.</p>
<p>Now we have the r<sup>2</sup>, which is the measure of the linkage disequilibrium and that can be computed with this equation. Previously, it was stated that the correlation itself, so the r, could be computed with this equation. So basically, the main question of this video is how to get from this to this.</p>
<p>Now to answer this question, we have to reformulate our example a little bit. And we consider two loci A and B again on one gamete but each with a possible random realization. We give the value of 1 to locus A with the probability of p<sub><em>A</em></sub> and the value of 0 with the probability of p 1 minus p­<sub><em>A</em></sub> , so this is basically the other allele. So this is the p<sub><em>a</em></sub> and p<sub><em>A</em></sub> and then this is the p<sub><em>a</em></sub>, but because p<sub><em>a</em></sub> and p<em>­<sub>A</sub></em> equal to one, so the sum of them is equal to one. So then the p<sub><em>a</em></sub> could be expressed as 1 minus p<sub><em>A</em></sub>. The very same thing happens with the locus B, so we assign a value of 1 with the probability of <em>B</em> and the value of 0 with the probability of one minus p<sub><em>B</em></sub>.</p>
<p>So this is a very particular example that we will follow up on in detail in the next video, but still I thought it’s useful to show it here so perhaps it’s eases some understanding. So basically what we have are two loci here: locus 1 and locus 2. So we have alleles capital <em>A,</em> lowercase <em>a</em>, and for locus 2, it’s&nbsp; alleles <em>B</em> and lowercase <em>b</em>. And basically what we do is we replace with the capital <em>A</em> with that ones and the lowercase <em>a</em> is with the zeros, so then it looks like this. So basically. we just count how many capital <em>A</em>’s we have, so that would be a 5. And how many capital <em>B</em>’s we have that would be a 6. And the joint occurrence of capital <em>A</em> and capital <em>B</em> would be 4 in this particular example.</p>
<p>Now, of course, we are interested in in a general example, so we introduce a population size of N and we can compute the proportion of the allele <em>A</em> as the sum of occurrence of allele <em>A</em> divided by the population size N. The same way, we can compute the proportion of <em>B</em> with the sum of the allele capital <em>B</em> divided by the population size N. And the joint occurrence of <em>A</em> and <em>B</em> we can compute when the jointly occurring <em>A</em> and <em>B</em> together divided by the population size N.</p>
<p><em>Follow up</em></p>
<p>Okay then the follow-up is what is the correlation between the realizations of 0 and 1 of a random variable at the two loci, and here comes again the equation for the correlation coefficient so that is the r. This equation basically has three parts, so that is one in this top, so basically the covariance, and the variance of x and the variance of y.</p>
<p>And basically we have all these parts figured out already in the previous slide as shown here, so it can be replaced by N times the joint occurrence of <em>A</em> and <em>B</em>. And the sum x can be replaced by N times the proportion of <em>A</em> and the y could be replaced as the N times proportion of <em>B</em>. And similarly, all the other parts could be replaced and then, in some cases, also adjusted, so we end up with such a beautiful and much more simple equations. To provide you a link to the next slide, I also color code them, so basically we have this orange, the green, and the blue part, which we then put back to the original correlation coefficient equation.</p>
<p>So this is the top part here is the correlation coefficient, and then we put in the orange, the green, and the blue part. And then you see here that the N is present all the way, so it can be actually removed from the equation and then only this part remains. So this part is basically the simple correlation between two loci 1 and 2 containing the alleles <em>A</em> and <em>B</em>, and if we square that equation, because we are interested in r<sup>2</sup> rather than a simple r, so then we have this correlation or a squared correlation coefficient that is the measure of the linkage disequilibrium as we have shown in the previous video and also in this one.</p>
<p><em>Summary</em></p>
<p>So, for the summary, the r<sup>2</sup> is a commonly used and robust measure of LD, and the computation of the r<sup>2</sup> is adapted based on the equation for the correlation coefficient. And for the allele and genotype frequencies in reality, of course, we talk about computation of linkage disequilibria between a large number of markers or marker pairs, so we use software for it, for example, PLINK or other software. And also, in the follow-up videos, we will actually show how it is done using PLINK itself. For today, I thank you for your time, thank you for your interest also in this advanced content, and I wish you a very nice continuation of the day.</p>
<hr>
</section>
<section id="sec-video4" class="level1">
<h1>Computing linkage disequilibrium</h1>
<p><strong>Title</strong>: Compute linkage disequilibrium (Part 1)</p>
<p><strong>Presenter(s)</strong>: Gábor Mészáros, PhD (Institute of Livestock Sciences (NUWI), University of Natural Resources and Life Sciences)</p>
<p><strong>Gábor Mészáros</strong>:</p>
<p>Hello, everyone. Welcome back to another video on the Genomics Boot Camp back again with another video on linkage disequilibrium. This is the first part of the finishing two when we are actually computing the linkage disequilibrium this time by hand. I believe this is an interesting piece of knowledge, so it’s worthwhile to look at.</p>
<p>So what we know so far. So LD characterizes the degree of relationship between two loci as always, and r<sup>2</sup> is the commonly used measure of the LD computed with the equation below.</p>
<p>And here we are at the first of the two examples I will show you today. The first one is the very basic one, and actually you might recall this 2x2 table from the previous videos. When we look at the r<sup>2</sup> equation, it is clear what we need to compute, and that is the proportion of <em>A</em>, proportion of <em>B</em>, and the proportion of the joint occurrence of <em>A</em> and <em>B</em>. Therefore, we are interested in what is in this segment or cell, in this other one for the <em>B</em>, and the joint occurrence of <em>A</em> and <em>B</em> together. Because we are speaking about proportions, we need to divide them with the sum of all alleles. So, this is already how we compute the proportions. So, the proportion of <em>A</em> is the 5 divided by 10, so 0.5. In this case proportion of the <em>B</em> allele is 6 divided by 10, so 0.6. And the joint occurrence is 4 divided by 10, 0.4. When we have our usual equation, we basically have all the unknowns, so the proportion of <em>A</em>, <em>B</em>, and <em>AB</em> and we put them in, and after the computation, we get the LD between these two loci A and B as 0.167.</p>
<p>So after this warm-up example, I show you the real deal. That is this LD calculation exercise that was shown by Professor Henner Simianer at the “Livestock Conservation Genomics Data Tools and Trends” workshop back in 2012 in Pag Island, Croatia. I really like this example, because it puts the LD calculation into context of haplotypes and all the allele combinations using SNPs. So first, I give you the initial example how it was given back in 2012. Then I give you the breakdown of the example, and you will have the chance to stop the video and do the computations yourself and, after that, you can look up the solution in this video.</p>
<p>So the exercise looks like this, so we have our genome here and we have a four SNPs. First one is an AT SNP, second one a CG SNP, third one is also a CG SNP, and the fourth is an AT SNP. We have also our population, and these are already the haplotypes, where this haplotype for our genome or part of the genome appears 17 times, this other one 14 times, 3 times, 3 times, 2 times, and this haplotype appears just 1 time in the population. The exercise is to calculate the LD between all pairs of loci. Now in this video, I will show you how to compute LD between locus 1 and 2 in detail, then I will show you the solutions for the two other pairs of loci and the last three you can follow up yourselves if you want.</p>
<p>So to give you a bit of a head’s up information, I list here the loci that you need to compute the proportions for, so for locus 1 is the A, the locus 2 is a C, locus 3 is also a C, and locus 4 is an A. You need to compute it for these alleles specifically, because these are the major alleles for these loci. So, if you count them up, so the A is the major allele for locus 1 and the C is for locus 2 and the C is also for locus 3 and A for locus 4, and obviously then you need to compute the joint occurrences between the two loci that you are following up and you want to compute LD for.</p>
<p>So, if you actually have all these proportions, you can compute the LD between all pairs or actually for pairs 1-2, 1-3, and 1-4 as we will list it in this video. And putting these proportions into the well-known equation, then you get the r<sup>2</sup> value for that pair of loci. Now, if you want to go ahead and do the calculations yourself on with pen and paper, then this is the moment to pause the video and well just go ahead with the computations. And after you are done or at least you are done with the locus, for example locus 1-2, then to resume the video and see if you have done well or if there is something to be corrected. Okay, so we are continuing with the solution in 3… 2… 1…</p>
<p>Now actually what needs to be done is pretty similar to the previous smaller case, but in this case, you need to build up the 2x2 table yourself, so here we have a locus 1 with an AT SNP, a locus 2 with the CG SNP. And because we told that the A is the actual major locus, then you actually need to count them up, so basically, you need to fill up this spot in the 2x2 table. For the locus 2, the C is the major locus, so you need to fill up this spot on the 2x2 table. And of course, the joint occurrence as well.</p>
<p>So how to do that? Of course, we will use the actual haplotype numbers as they are given in the exercise. Actually, right now, we are looking at locus 1 and locus 2, so basically these two columns are interesting for us, so we can actually hide the other ones so that they don’t bother us too much.</p>
<p>Now perhaps the first thing you might consider is that, well, we need to calculate the proportions, so we basically need to know how many haplotypes are there total. So basically, we add up 17 plus 14 plus 3 plus 3 plus 2 plus 1 and, when we do that, we actually arrived number 40, so this is the total number of haplotypes now.</p>
<p>For locus 1, we need to count how many times the allele A appears, so in this haplotype, there is an A so, it’s 17 times. So it’s 17. Here in the locus one is a T, so that is we don’t count. This also there is an A here and A here, here. There is a T here, so we don’t count this, and the A here. So basically, we have a 17 plus 3 plus 3 plus 1 - that is together 24.</p>
<p>Following the same logic for locus 2, in this case, we count the C allele. So here we have a C, so we count this. Here we have a G, that so we don’t count. This count, this, this, and this, so everywhere where is the c, so there is 17 plus 3 plus 3 plus 2 and that is together 25.</p>
<p>The last thing we need to find out that how many times the A and C appear together so here the A and C appear together, so that we count, this we don’t count this, but also AC here, AC here. Here although there is a C, but there is not an A, so we don’t count this part. And also here is an A but there is a G here, so it’s not an AC combination, so we don’t count this. So basically, we count this 17, these three, and this three, which is together 23.</p>
<p>And because we are actually interested in proportions rather than the numbers themselves. So we divide for the locus 1, the proportion of A is 24 divided by 40 - that is 0.6. And therefore, locus 2, the proportion of C is 25 divided by 40 - that is 0.625. And the joint occurrence the same way, so the 23 divided by 40 and that is this number 0.575.</p>
<p>So with this, we already have everything. So we have a proportion of A, proportion of C, and the joint occurrence, so we have our beautiful equation here. So this is the joint occurrence and this would be the proportion of A and proportion of C, so we put them in into the equation itself and then we end up with an LD between locus 1 and locus 2 as 0.711, so this is the LD between these two loci.</p>
<p>On this slide, I give you all the results for the other loci, so locus 1, 2, 3, and 4 and the joint occurrences of these three pairs. And if we fill them in into the equation, the well-known equation, then we end up with – well, this is just a repetition from before - and then there is the LD between locus 1-3 and the LD between locus 1 and 4, so this is basically it this is how you compute LD by hand.</p>
<p>So, for the summary, an example of the LD computation by hand was shown, which is not a very widespread piece of knowledge, so I argue that is really good to have it in your inventory. But on the other hand, we also have to note that this manual mode of computation is not very effective. For that, we need to use software solutions that are able to handle computations of LD between thousands and hundreds of thousands of loci, and such computations will be shown in the next video. For today, I thank you for your time and have a very nice rest of the day.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          // default icon
          link.classList.add("external");
      }
    }
});
</script>
</div> <!-- /content -->



</body></html>